---
#- name: copy maya packaes 
#  copy: 
#    src: ./mayapk
#    dest: /mayapk/

#- name: install maya packages and deps
#  vars:
#    - ans_home: /home/ansible/2022
#  yum: 
#    name: ['{{ ans_home }}/mayapkg/adlmapps26-26.0.7-0.x86_64.rpm', 
#           '{{ ans_home }}/mayapkg/adskflexnetclient-11.18.0-0.x86_64.rpm',
#           '{{ ans_home }}/mayapkg/adskflexnetserverIPV6-11.18.0-0.x86_64.rpm',
#           '{{ ans_home }}/mayapkg/adsklicensing12.2.0.17-0-0.x86_64.rpm',
#           '{{ ans_home }}/mayapkg/xcb-util-renderutil-0.3.9-3.el7.x86_64.rpm',
#           '{{ ans_home }}/mayapkg/xcb-util-wm-0.4.1-5.el7.x86_64.rpm']
#    state: present 

- name: check MayaConfig file and directory exist
  stat:
    path: /var/opt/Autodesk/Adlm/Maya2022/MayaConfig.pit
  register: folder_file

- name: checking MayaConfig.pit
  debug: 
    msg: File MayaConfig.pit already present system configured
  when: folder_file.stat.exists

- name: creating Maya2022 directory
  file:
    path: /var/opt/Autodesk/Adlm/Maya2022
    state: directory
  when: folder_file.stat.exists == false


#- name: check file exists
  #stat:
  #  path: /var/opt/Autodesk/Adlm/Maya2022/MayaConfig.pit
  #register: file

- name: copying MayaConfig.pit
  copy:
    src: ./config_files/MayaConfig_2022.pit
    dest: /var/opt/Autodesk/Adlm/Maya2022/MayaConfig.pit
  when: folder_file.stat.exists == false

- name: mapping MayaConfig.pit
  command:  /opt/Autodesk/AdskLicensing/Current/helper/AdskLicensingInstHelper register -pk 
                657N1 -pv 2022.0.0.F -el EN_US -cf /var/opt/Autodesk/Adlm/Maya2022/MayaConfig.pit -lm USER 
  when: folder_file.stat.exists == false
